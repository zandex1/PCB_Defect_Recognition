# PCB_Defect_Recognition
## Описание
1) Цель — разработать комплект ПО стенда автоматизированного визуального контроля качества монтажа (ПП) на основе системы технического зрения для следующего типа дефектов:
- не установка элемента;
- перепутывание резистора и конденсатора.

2) Задачи практики<br >
В ходе практики требуется выполнить следующие задачи:

1. Разработка/настройка канала ввода видеоданных.
Канал ввода должен обеспечивать прием изображений с задержкой не более 40мс, 
с максимальной для источника сигнала частотой кадров и разрешением, 
поддерживать управление временем экспозиции, балансом белого и 
пр. доступными параметрами источника.
2. Разработка/настройка драйвера координатного стола.
Драйвер координатного стола должен поддерживать работу стенда в режиме юстировки, 
сканирования, иметь возможность программировать закон управления движением.
3. Разработка UI/UX стенда.
Должно быть разработано кроссплатформенное приложение с поддержкой требуемого 
функционала:
- загрузка gerber файлов дизайна платы;
- создание, сохранение, удаление, загрузка проекта;
- создание, редактирование референса ПП;
- режим юстировки стола;
- сканирование текущей платы;
- обнаружение и подсветка дефектов;
- ручной (с подсказками) и авторежим контроля дефектов.
4. Разработка библиотеки функций ЦОИ.
Необходимо разработать библиотеку функций (Python/C++), реализующих:
- сегментацию ПП;
- сшивку панорамы (мозаики);
- ректификацию (ортофото) изображения ПП;
- калибровку, юстировку сенсора;
- коррекцию / нормировку цветности.
5. Сбор и разметка датасета.
При помощи разработанного комплекта ПО осуществить сбор необходимого датасета. 
Разметку осуществить про помощи CVAT.
6. Обучение детекционной НС.
На основе полученного датасета выполнить обучение детекционной / сегментационной 
сети с целью обнаружения дефектов по п.4.
7. Разработка и тестирование алгоритма выявления дефектов монтажа ПП.

## Запуск

1) Установка библиотек:<br />
```pip install -r requirements.txt```

2) Запуск:<br />
```python project_python/main.py```<br /><br />
Если выводится ошибка: ```[ WARN:0@0.051] global cap_v4l.cpp:982 open VIDEOIO(V4L2:/dev/video2): can't open camera by index```<br />
То необходимо в файле ```project_python/util.py``` поменять значение в ```VideoCapture``` на необходимый вам порт камеры.<br /><br />
Если выводится ошибка: ```ERROR:'Microcontroller not connected'```<br />
То необходимо в файле ```project_python/main.py``` поменять значение ```/dev/ttyACM0``` на необходимый вам порт контроллера.<br />

## Полезная информация

1) Для просмотра занятых портов на ОС Linux необходимо перейти в директорию ```\dev``` и выполнить команду ```ls```;
2) По ссылке [command sheet EiBotBoard](https://evil-mad.github.io/EggBot/ebb.html) находится документация к микроконтроллеру;
3) В документе 'Изучаем OpenCV.pdf' содержиться полезная информация по работе с данной библиотекой;
4) Алгоритм правильной декомпозиции матрицы Гомографии, рекомендовано попросить у Кирилла Морева;
5) По ссылке [координатный стол](https://aliexpress.ru/item/32967896875.html?spm=.search_results.16.4a6b69de01dgo5&sku_id=66609634047) содержаться технические характеристики стенда;
6) По ссылке [видеомикроскоп](https://aliexpress.ru/item/32504912023.html?sku_id=59083326102&spm=a2g2w.productlist.search_results.4.55f272bdnC36wT) содержаться технические характеристики видеомикроскопа;
7) В папке ```diagrams/``` содержаться часть UML схем необходимых для написания проектной документации. Все схемы выполнены с помощью инфструмента PlantUML, он позволяет описывать UML диаграммы в виде кода. Для их просмотра необходимо установить Java и расширение для VScode ```PlantUML``` или, перейдя по [ссылке](https://www.plantuml.com/plantuml/uml/SyfFKj2rKt3CoKnELR1Io4ZDoSa70000), можно будет воспользоваться WEB версией инструмента.